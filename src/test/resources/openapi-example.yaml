openapi: "3.0.3"
info:
  title: Example of events exchanged within a REST pull API
  version: "${project.version}"
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
servers:
  - url: /eventDemo/v1
paths:
  /events:
    get:
      summary: Retrieve address change events
      operationId: getEvents
      parameters:
        - name: "cursor"
          in: query
          schema:
            type: string
      responses:
        "200":
          description: Batch of cloud events
          content:
            application/cloudevents-batch+json:
              schema:
                $ref: "#/components/schemas/AddressCloudEventBatch"
              x-ignore-rules:
                evo-object: allow array as top level data structure in order to comply with the CloudEvents standard
        default:
          $ref: "../../main/openapi/problem/v1/problem-v1.yaml#/components/responses/ProblemResponse"
    post:
      summary: Register an address change event
      operationId: createEvent
      requestBody:
        content:
          application/cloudevents+json:
            schema:
              $ref: "./composition-example.yaml#/components/schemas/AddressEvent"
        required: true
      responses:
        "201":
          description: Event created
        default:
          $ref: "../../main/openapi/problem/v1/problem-v1.yaml#/components/responses/ProblemResponse"
  x-ignore-rules:
    hlth-res: A health resource is not in scope of this demo
components:
  schemas:
    AddressCloudEventBatch:
      type: array
      items:
        $ref: "./composition-example.yaml#/components/schemas/AddressEvent"